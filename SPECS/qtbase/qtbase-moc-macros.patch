From 623a7c414276266e8ccbae7608398489ee96c1cd Mon Sep 17 00:00:00 2001
From: Sam Meluch <sammeluch@microsoft.com>
Date: Mon, 29 Jan 2024 13:49:01 -0800
Subject: [PATCH] moc macros patch

---
 src/tools/moc/main.cpp | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/src/tools/moc/main.cpp b/src/tools/moc/main.cpp
index 3df832cc..3dc35754 100644
--- a/src/tools/moc/main.cpp
+++ b/src/tools/moc/main.cpp
@@ -166,6 +166,11 @@ int runMoc(int argc, char **argv)
     Moc moc;
     pp.macros["Q_MOC_RUN"];
     pp.macros["__cplusplus"];
+    pp.macros["_SYS_SYSMACROS_H_OUTER"];
+    Macro macro;
+    macro.symbols = Preprocessor::tokenize(QByteArray::number(Q_PROCESSOR_WORDSIZE*8), 1, Preprocessor::TokenizeDefine);
+    macro.symbols.removeLast(); // remove the EOF symbol
+    pp.macros.insert("__WORDSIZE", macro);
 
     // Don't stumble over GCC extensions
     Macro dummyVariadicFunctionMacro;
-- 
2.34.1

